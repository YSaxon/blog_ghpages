<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Yaakov Saxon's Security Blog - Hacking</title><link href="https://blog.stepaheadcyber.com/" rel="alternate"></link><link href="https://blog.stepaheadcyber.com/feeds/hacking.atom.xml" rel="self"></link><id>https://blog.stepaheadcyber.com/</id><updated>2023-07-05T00:00:00-04:00</updated><entry><title>Reverse Engineering Legu Encryption</title><link href="https://blog.stepaheadcyber.com/reverse-engineering-legu-encryption.html" rel="alternate"></link><published>2023-07-05T00:00:00-04:00</published><updated>2023-07-05T00:00:00-04:00</updated><author><name>Yaakov Saxon</name></author><id>tag:blog.stepaheadcyber.com,2023-07-05:/reverse-engineering-legu-encryption.html</id><summary type="html">&lt;p&gt;I recently came across an Android APK that was protected by an obfuscator made by the Chinese tech company Tencent, called Legu. Thankfully, there was a repo available to reverse the obfuscation, but it was out-of-date with respect to the encryption. Specifically, the repo said it supported up to 4 â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;I recently came across an Android APK that was protected by an obfuscator made by the Chinese tech company Tencent, called Legu. Thankfully, there was a repo available to reverse the obfuscation, but it was out-of-date with respect to the encryption. Specifically, the repo said it supported up to 4.0.1.18, and the version I was seeing was 4.0.1.31. Also, the dependencies were pretty difficult to use.&lt;/p&gt;
&lt;p&gt;The TLDR is that I reverse engineered the new encryption scheme (it's now using ChaCha20) and the new key derivation scheme (a multi step process involving two hardcoded keys being altered in subtle ways, and one decoy key not used at all), and updated and published a fork at [https://github.com/YSaxon/legu_unpacker_2023].&lt;/p&gt;
&lt;p&gt;But you won't always find the version you need there, if only because Tencent is likely to continue to update the keys. So I wrote up the &lt;em&gt;process&lt;/em&gt; of reverse engineering the encryption, so that it can always be updated in the future.&lt;/p&gt;
&lt;p&gt;You can find that writeup &lt;a href="https://github.com/YSaxon/legu_unpacker_2023/blob/master/reverse_engineering_tips/reverse_engineering_tips.md"&gt;here&lt;/a&gt;&lt;/p&gt;</content><category term="Hacking"></category></entry></feed>